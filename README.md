# ヘルスケアアプリ

## 概要

このアプリは、動的計画法（Dynamic Programming）を用いて最適なトレーニングメニューを提案するヘルスケアアプリケーションです。ユーザーの現在の健康状態に基づいて、期間とコスト制約下で最も効果的なトレーニング戦略を計算します。

## 主な機能

### ログイン機能
- シンプルなユーザー認証システム
- URLパラメータによる永続的なセッション管理
- 24時間の自動セッション期限切れ
- ワンクリックログアウト
- ページリロード時の自動ログイン復元

###　アプリ１ページ
- 基本的な動的計画法による最適化
- 3つの行動選択肢（高強度・中強度・低強度）
- 貪欲方策による最適行動の決定
- 期間別の状態変化予測

### アプリ２ページ
- 高度な動的計画法による最適化
- 4つの行動選択肢（行動1-4）
- スキルレベル別の遷移確率（初心者・中級者・上級者）
- 期間の自動3等分によるスキル向上シミュレーション
- 最適ポリシーの詳細分析

### 結果保存機能
- **CSV形式**: トレーニングメニューの詳細データ
- **JSON形式**: 設定情報と計算結果
- **TXT形式**: 読みやすい結果サマリー

## 技術仕様

### 使用技術
- **フレームワーク**: Streamlit
- **数値計算**: NumPy, Pandas
- **認証**: URLパラメータベースのセッション管理
- **言語**: Python 3.9+

### アルゴリズム
- **動的計画法**: 状態遷移とコスト制約下での最適化
- **貪欲方策**: 各期間での最適行動選択
- **スキルレベル別遷移**: 期間に応じた能力向上のモデル化

## ファイル構成

```
research/
├── app.py              # メインアプリケーション
├── login.py            # ログイン機能モジュール
├── dev.py              # アプリ１ページ
├── mydev.py            # アプリ２ページ（初心者向け）
├── main.py             # 基本的なヘルスケアアプリ
└── README.md           # このファイル
```

## セットアップ

### 1. 環境構築
```bash
# 仮想環境の作成（推奨）
python -m venv venv
source venv/bin/activate  # Windows: venv\Scripts\activate

# 依存関係のインストール
pip install streamlit numpy pandas
```

### 2. アプリの起動
```bash
streamlit run app.py
```

### 3. アクセス
- ブラウザで `http://localhost:8501` にアクセス
- ログイン画面で認証情報を入力

## 使用方法

### ログイン
- **ユーザー名**: `user`
- **パスワード**: `123456`
- **セッション管理**: ログイン後24時間は自動的にログイン状態を維持
- **URLパラメータ**: 認証情報がURLに保存され、ページリロード時も復元

### 基本操作
1. **ホームページ**: アプリの概要と使い方を確認
2. **アプリ１ページ**: 基本的な最適化機能を使用
3. **アプリ２ページ**: 高度なスキルレベル別最適化を使用

### パラメータ設定
- **現在の状態**: 良い・普通・悪いから選択
- **期間**: 1-30日間から選択
- **コスト制限**: 1-6の範囲で設定

## 特徴

### アプリ1との違い
- **基本的な最適化**: 3つの行動選択肢
- **固定遷移確率**: スキルレベルを考慮しない
- **シンプルな計算**: 理解しやすいアルゴリズム

### アプリ２の革新性
- **スキルレベル別遷移**: 期間に応じた能力向上をモデル化
- **4つの行動選択肢**: より細かい制御が可能
- **自動期間分割**: 初心者・中級者・上級者期間の自動設定
- **高度な最適化**: より現実的なトレーニング戦略の提案

## 結果の解釈

### 出力データ
- **最終時点のs1確率**: 目標状態（良い状態）の達成確率
- **平均s1確率**: 期間全体での平均的な良い状態の確率
- **トレーニングメニュー**: 各期間での推奨行動と状態変化

### スキルレベル
- **初心者期間**: 保守的な遷移確率（改善しにくい）
- **中級者期間**: 中間的な遷移確率
- **上級者期間**: 積極的な遷移確率（改善しやすい）

## セキュリティ機能

### 認証システム
- **URLパラメータ認証**: ユーザー名、セッションID、ログイン時間をBase64エンコード
- **セッション期限**: 24時間の自動期限切れ
- **セッションID生成**: MD5ハッシュによる一意のセッション識別
- **自動ログアウト**: 期限切れ時の自動セッション無効化

### セキュリティ対策
- **パスワード非表示**: 入力時のパスワードマスキング
- **セッション検証**: ログイン時間とセッションIDの二重チェック
- **URLパラメータクリア**: ログアウト時の認証情報完全削除

## 今後の拡張予定

- [x] 永続的なログイン機能（URLパラメータ認証）
- [x] セッション管理と自動期限切れ
- [ ] データベース連携によるユーザー管理
- [ ] グラフによる結果の可視化
- [ ] 設定の保存・読み込み機能
- [ ] 複数ユーザー対応
- [ ] モバイル対応
- [ ] より高度なセキュリティ機能（JWT認証など）


